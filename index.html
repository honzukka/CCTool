<!DOCTYPE html>
<html lang="en">
<head>
	<title>CC Tool</title>
	<meta charset="utf-8">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
</head>
<body>

<h1>Upload txt or xml data only!</h1>
<form enctype="multipart/form-data">
	Select txt file to upload:
	<input type="file" name="fileToUpload" id="fileToUpload" />
	<input type="button" value="Upload" />
</form>
<progress></progress>
<br><br>
<pre id="response"></pre>

<script>
// place any file checks here - this will be called whenever the file to upload changes
$(":file").on("change", function(){
	var file = this.files[0];
	if (file.type != "text/xml" && file.type != "text/plain")
	{
		alert("Unsupported file type. Supportes file types: .txt, .xml");
		this.form.reset();
	}
});

$(":button").on("click", function(){
	$.ajax({
		url: "process.php",
		type: "POST",
		
		// intialize FormData with a file from the form
		data: new FormData($("form")[0]),
		
		cache: false,
		contentType: false,
		processData: false,
		
		// a custom XmlHttpRequest allows for various callbacks on completion of the request itself
		xhr: function(){
			var myXhr = $.ajaxSettings.xhr();
			if (myXhr.upload)
			{
				myXhr.upload.addEventListener('progress', function(e){
					if (e.lengthComputable)
					{
						$('progress').attr({value: e.loaded, max: e.total});
					}
				}, false);
			}
			return myXhr;
		},
		
		// this callback receives data from the php code
		success: function(data){
			//$("#response").html(data);
			var obj = JSON.parse(data);
			$("#response").html(JSON.stringify(obj, undefined, 2));
		}
	});
});
</script>

</body>
</html>